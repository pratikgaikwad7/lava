<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>टाटा मोटर्स - क्लब्ड प्रशिक्षण अभिप्राय फॉर्म</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        :root {
            --primary-color: #003366;
            --secondary-color: #0066cc;
            --accent-color: #ff6b00;
            --accent-light: #ff8c33;
            --light-bg: #f8fafc;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
            --transition: all 0.3s ease;
            --gradient-primary: linear-gradient(135deg, var(--primary-color) 0%, #004080 100%);
            --gradient-secondary: linear-gradient(135deg, var(--secondary-color) 0%, #0080ff 100%);
            --gradient-accent: linear-gradient(135deg, var(--accent-color) 0%, #ff8c33 100%);
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            color: #333;
            line-height: 1.6;
            padding: 10px;
        }
        
        .container {
            max-width: 1000px;
            margin: 10px auto;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            position: relative;
        }
        
        .header {
            background: var(--gradient-primary);
            color: white;
            padding: 15px 10px;
            text-align: center;
            position: relative;
            clip-path: polygon(0 0, 100% 0, 100% 90%, 0 100%);
            padding-bottom: 30px;
        }
        
        .header-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 1;
        }
        
.header-logo {
    width: 70px;
    height: 70px;
    background: white url('/static/image/logo1.jpeg') center/100% no-repeat;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: var(--card-shadow);
    border: 3px solid #fff;
    overflow: hidden;
    margin-bottom: 12px;
    transition: transform 0.3s ease;
}

.header-logo:hover {
    transform: scale(1.05);
}

        .header h1 {
            font-size: 18px;
            margin-bottom: 6px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
            font-weight: 700;
        }
        
        .header h2 {
            font-size: 14px;
            font-weight: 400;
            margin-bottom: 4px;
        }
        
        .form-container {
            padding: 15px;
        }
        
        .section {
            margin-bottom: 15px;
            padding-bottom: 12px;
            border-bottom: 1px solid #e0e6ed;
        }
        
        .section:last-child {
            border-bottom: none;
        }
        
        .section-title {
            color: var(--primary-color);
            font-size: 16px;
            margin-bottom: 12px;
            padding-bottom: 6px;
            border-bottom: 3px solid var(--secondary-color);
            position: relative;
            font-weight: 600;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 80px;
            height: 3px;
            background-color: var(--accent-color);
        }
        
        .form-row {
            display: flex;
            flex-wrap: wrap;
            margin: 0 -8px 10px;
        }
        
        .form-group {
            flex: 1 0 100%;
            padding: 0 8px;
            margin-bottom: 10px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: var(--primary-color);
            font-size: 12px;
            position: relative;
        }
        
        label.required::after {
            content: '*';
            color: #dc3545;
            margin-left: 4px;
        }
        
        input[type="text"],
        input[type="date"],
        input[type="tel"],
        textarea,
        select {
            width: 100%;
            padding: 12px;
            border: 1px solid #cbd5e0;
            border-radius: 8px;
            font-size: 16px; /* Larger font for better mobile readability */
            transition: var(--transition);
            background-color: #fff;
        }
        
        input:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.15);
        }
        
        textarea {
            min-height: 80px;
            resize: vertical;
            line-height: 1.5;
        }
        
        .question {
            margin-bottom: 15px;
            padding: 10px;
            background-color: var(--light-bg);
            border-radius: 8px;
            border-left: 4px solid var(--secondary-color);
            transition: var(--transition);
            box-shadow: var(--card-shadow);
        }
        
        .question:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }
        
        .question-text {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--primary-color);
            font-size: 13px;
            line-height: 1.4;
        }
        
        .options {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .option {
            display: flex;
            align-items: center;
            font-size: 12px;
            cursor: pointer;
            padding: 5px 8px;
            border-radius: 6px;
            transition: var(--transition);
            flex: 1 0 calc(50% - 8px);
            min-width: 110px;
        }
        
        .option:hover {
            background-color: rgba(0, 102, 204, 0.1);
        }
        
        .option input {
            margin-right: 5px;
            width: 16px;
            height: 16px;
            cursor: pointer;
        }
        
        .trainer-section {
            background-color: #f0f7ff;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 12px;
            box-shadow: var(--card-shadow);
            transition: var(--transition);
        }
        
        .trainer-section:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }
        
        .trainer-title {
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 14px;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .trainer-title i {
            margin-right: 8px;
            color: var(--secondary-color);
        }
        
        .btn-container {
            display: flex;
            justify-content: center;
            margin: 20px 0 10px;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 15px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            flex: 1 0 130px;
            max-width: 180px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }
        
        .btn-submit {
            background: var(--gradient-secondary);
            color: white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.12);
        }
        
        .btn-reset {
            background-color: #e2e8f0;
            color: #4a5568;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
        }
        
        .btn-submit:hover {
            background: var(--gradient-primary);
        }
        
        .btn-reset:hover {
            background-color: #d1d8e0;
        }
        
        .footer {
            text-align: center;
            padding: 15px;
            background-color: var(--primary-color);
            color: #cbd5e0;
            font-size: 12px;
            clip-path: polygon(0 20%, 100% 0, 100% 100%, 0% 100%);
            padding-top: 20px;
        }
        
        /* Employee details card styles */
        .detail-card {
            background: #fff;
            padding: 10px;
            border-radius: 8px;
            border-left: 4px solid var(--secondary-color);
            margin-bottom: 10px;
            box-shadow: var(--card-shadow);
        }
        
        .detail-label {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 3px;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .detail-value {
            color: #495057;
            font-weight: 500;
            font-size: 12px;
        }
        
        .loading-spinner {
            display: none;
        }
        
        .is-invalid {
            border-color: #dc3545 !important;
        }
        
        .invalid-feedback {
            color: #dc3545;
            font-size: 11px;
            margin-top: 5px;
            display: block;
        }
        
        /* Completely restructured input group for mobile */
        .input-group-wrapper {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 5px;
        }
        
        .input-field {
            position: relative;
            flex: 1;
        }
        
        .input-field input {
            width: 100%;
            padding: 14px 15px;
            border: 1px solid #cbd5e0;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            transition: var(--transition);
            height: 50px; /* Fixed height for consistency */
        }
        
        .input-field input:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.15);
        }
        
        .verify-button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            background: var(--gradient-secondary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            height: 50px; /* Same height as input */
            white-space: nowrap;
        }
        
        .verify-button:hover {
            background: var(--gradient-primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        .verify-button:active {
            transform: translateY(0);
        }
        
        .verify-button i {
            font-size: 14px;
        }
        
        /* Custom radio buttons */
        .custom-radio {
            position: relative;
            padding-left: 25px;
            cursor: pointer;
            user-select: none;
            font-size: 12px;
        }
        
        .custom-radio input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }
        
        .radio-checkmark {
            position: absolute;
            top: 0;
            left: 0;
            height: 18px;
            width: 18px;
            background-color: #fff;
            border: 2px solid #cbd5e0;
            border-radius: 50%;
            transition: var(--transition);
        }
        
        .custom-radio:hover input ~ .radio-checkmark {
            border-color: var(--secondary-color);
        }
        
        .custom-radio input:checked ~ .radio-checkmark {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
        }
        
        .radio-checkmark:after {
            content: "";
            position: absolute;
            display: none;
        }
        
        .custom-radio input:checked ~ .radio-checkmark:after {
            display: block;
        }
        
        .custom-radio .radio-checkmark:after {
            top: 3px;
            left: 3px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: white;
        }
        
        /* Info box */
        .info-box {
            font-size: 13px;
            color: var(--primary-color);
            background-color: #f0f7ff;
            padding: 10px;
            border-radius: 8px;
            border-left: 4px solid var(--accent-color);
            margin-bottom: 12px;
            display: flex;
            align-items: flex-start;
        }
        
        .info-box i {
            margin-right: 10px;
            color: var(--accent-color);
            font-size: 16px;
            flex-shrink: 0;
        }
        
        /* Trainer name input */
        .trainer-name-input {
            width: 100%;
            max-width: 250px;
            display: block;
            margin-left: 5px;
            padding: 8px 10px;
            font-size: 13px;
            margin-top: 5px;
        }
        
        /* Program section */
        .program-section {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid #e9ecef;
            box-shadow: var(--card-shadow);
        }
        
        .program-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--secondary-color);
        }
        
        .program-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary-color);
            margin: 0;
        }
        
        .program-date {
            font-size: 12px;
            color: #6c757d;
            background-color: #e9ecef;
            padding: 3px 8px;
            border-radius: 20px;
        }
        
        /* Training Programs Section */
        .training-programs {
            background-color: #f0f7ff;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid #e9ecef;
            box-shadow: var(--card-shadow);
        }
        
        .training-programs-header {
            color: var(--primary-color);
            font-size: 16px;
            margin-bottom: 12px;
            padding-bottom: 6px;
            border-bottom: 3px solid var(--secondary-color);
            position: relative;
            font-weight: 600;
        }
        
        .training-programs-header::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 80px;
            height: 3px;
            background-color: var(--accent-color);
        }
        
        .training-program-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 12px;
            margin-bottom: 8px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            transition: var(--transition);
        }
        
        .training-program-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .training-program-name {
            font-weight: 600;
            color: var(--primary-color);
            font-size: 13px;
        }
        
        .training-program-date {
            font-size: 12px;
            color: #6c757d;
            background-color: #e9ecef;
            padding: 3px 8px;
            border-radius: 20px;
        }
        
        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section {
            animation: fadeIn 0.5s ease forwards;
        }
        
        .section:nth-child(2) { animation-delay: 0.1s; }
        .section:nth-child(3) { animation-delay: 0.2s; }
        .section:nth-child(4) { animation-delay: 0.3s; }
        .section:nth-child(5) { animation-delay: 0.4s; }
        .section:nth-child(6) { animation-delay: 0.5s; }
        .section:nth-child(7) { animation-delay: 0.6s; }
        .section:nth-child(8) { animation-delay: 0.7s; }
        
        /* Mobile-first approach with responsive breakpoints */
        @media (min-width: 576px) {
            body {
                padding: 15px;
            }
            
            .container {
                margin: 15px auto;
            }
            
            .header {
                padding: 20px 15px 35px;
            }
            
            .header h1 {
                font-size: 20px;
            }
            
            .header h2 {
                font-size: 16px;
            }
            
            .form-container {
                padding: 20px;
            }
            
            .section-title {
                font-size: 18px;
            }
            
            /* Horizontal layout for larger screens */
            .input-group-wrapper {
                flex-direction: row;
                gap: 10px;
            }
            
            .input-field {
                flex: 2;
            }
            
            .verify-button {
                flex: 1;
                max-width: 150px;
            }
            
            .option {
                flex: 0 0 auto;
            }
        }
        
        @media (min-width: 768px) {
            body {
                padding: 20px;
            }
            
            .header {
                padding: 25px 20px 40px;
            }
            
            .header h1 {
                font-size: 24px;
            }
            
            .header h2 {
                font-size: 18px;
            }
            
            .form-container {
                padding: 25px;
            }
            
            .section-title {
                font-size: 20px;
            }
            
            .form-group {
                flex: 1 0 calc(50% - 16px);
            }
            
            label, .question-text {
                font-size: 14px;
            }
            
            input[type="text"],
            input[type="date"],
            input[type="tel"],
            textarea {
                font-size: 15px;
            }
            
            .option {
                font-size: 14px;
            }
            
            .btn {
                flex: 0 0 auto;
            }
        }
        
        /* Desktop screens */
        @media (min-width: 992px) {
            .form-group {
                flex: 1 0 calc(33.333% - 16px);
            }
            
            .header h1 {
                font-size: 26px;
            }
            
            .header h2 {
                font-size: 20px;
            }
            
            .header-logo {
                width: 90px;
                height: 90px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="header-logo">
                </div>
                <h1>कार्यक्रमांबाबत प्रशिक्षणार्थ्यांचा अभिप्राय</h1>
                <h2>(CIRO Feedback)</h2>
                <h2>स्किल डेव्हलपमेंट सेंटर टी. एम. सी. वी. पुणे</h2>
            </div>
        </div>
        
        <div class="form-container">
            <form action="{{ url_for('feedback.submit_clubbed_feedback') }}" method="POST" id="clubbedFeedbackForm">
                <!-- Hidden field to store all program IDs -->
                <input type="hidden" name="program_ids" value="{{ program_ids_str }}" id="program_ids_field">
                <input type="hidden" name="participants_name" id="participants_name_hidden" value="">

                <!-- Training Programs Section -->
                <div class="training-programs">
                    <h3 class="training-programs-header">प्रशिक्षण कार्यक्रम</h3>
                    {% for program in programs %}
                    <div class="training-program-item">
                        <div class="training-program-name">{{ program.training_name }}</div>
                        <div class="training-program-date">{{ program.start_date.strftime('%Y-%m-%d') }}</div>
                    </div>
                    {% endfor %}
                </div>

                <!-- Participant Details -->
                <div class="section">
                    <h3 class="section-title">प्रशिक्षणार्थ्याची माहिती</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="per_no" class="required">टिकीट क्र. / Employee Ticket No.:</label>
                            <div class="input-group-wrapper"> 
                                <div class="input-field">
                                    <input type="text" class="form-control" id="per_no" name="per_no" 
                                           placeholder="Enter Ticket number" required>
                                </div>
                                <button class="verify-button" type="button" id="verifyPerNoBtn">
                                    <i class="fas fa-search"></i>
                                    <span id="verifyText">Verify</span>
                                    <span id="verifySpinner" class="spinner-border spinner-border-sm loading-spinner" role="status"></span>
                                </button>
                            </div>
                            <div class="invalid-feedback" id="perNoError"></div>
                        </div>
                    </div>
        
                    <!-- Employee Details (Dynamic) -->
                    <div id="employeeSection" style="display: none;">
                        <div class="form-row">
                            <div class="form-group">
                                <div class="detail-card">
                                    <div class="detail-label">Full Name</div>
                                    <div class="detail-value" id="participants_name"></div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="detail-card">
                                    <div class="detail-label">BC Number</div>
                                    <div class="detail-value" id="bc_no"></div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="detail-card">
                                    <div class="detail-label">Gender</div>
                                    <div class="detail-value" id="gender"></div>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <div class="detail-card">
                                    <div class="detail-label">Employee Group</div>
                                    <div class="detail-value" id="employee_group"></div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="detail-card">
                                    <div class="detail-label">Department</div>
                                    <div class="detail-value" id="department"></div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="detail-card">
                                    <div class="detail-label">Factory</div>
                                    <div class="detail-value" id="factory"></div>
                                </div>
                            </div>
                        </div>
                    </div>
        
                    <div class="form-row">
                        <div class="form-group">
                            <label for="phone" class="required">फोन :</label>
                            <input type="tel" id="phone" name="phone" pattern="[0-9]{10}" required>
                        </div>
                        <div class="form-group">
                            <label for="SeniorName" class="required">वरिष्ठांचे नाव :</label>
                            <input type="text" id="SeniorName" name="senior_name" required>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <div class="info-box">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>सूचना :</strong> खाली दिलेल्या सर्व कार्यक्रमांसाठी अभिप्राय द्या. प्रत्येक कार्यक्रमासाठी वेगवेगळे प्रश्न आहेत.
                        </div>
                    </div>
                </div>
                
                <!-- Common Section 1: Participant Preparation -->
                <div class="section">
                    <h3 class="section-title">१. प्रशिक्षणार्थ्याची पूर्वतयारी</h3>
                    
                    <div class="question">
                        <div class="question-text">१. मला या विषयाची जुजबी माहिती कार्यक्रमाला येण्याअगोदर होती.</div>
                        <div class="options">
                            <label class="option custom-radio">
                                <input type="radio" name="sec1_q1" value="1" required>
                                <span class="radio-checkmark"></span>
                                पूर्णपणे असहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec1_q1" value="2">
                                <span class="radio-checkmark"></span>
                                असहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec1_q1" value="3">
                                <span class="radio-checkmark"></span>
                                सहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec1_q1" value="4">
                                <span class="radio-checkmark"></span>
                                पूर्णपणे सहमत
                            </label>
                        </div>
                    </div>
                    
                    <div class="question">
                        <div class="question-text">२. मला या कार्यक्रमाचे उद्दिष्ट समजले आहे.</div>
                        <div class="options">
                            <label class="option custom-radio">
                                <input type="radio" name="sec1_q2" value="1" required>
                                <span class="radio-checkmark"></span>
                                पूर्णपणे असहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec1_q2" value="2">
                                <span class="radio-checkmark"></span>
                                असहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec1_q2" value="3">
                                <span class="radio-checkmark"></span>
                                सहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec1_q2" value="4">
                                <span class="radio-checkmark"></span>
                                पूर्णपणे सहमत
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- Common Section 2: Program Content -->
                <div class="section">
                    <h3 class="section-title">२. कार्यक्रमात समाविष्ट करण्यात आलेली माहिती.</h3>
                    
                    <div class="question">
                        <div class="question-text">१. माझ्या कामाशी संबंधित होती</div>
                        <div class="options">
                            <label class="option custom-radio">
                                <input type="radio" name="sec2_q1" value="1" required>
                                <span class="radio-checkmark"></span>
                                पूर्णपणे असहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec2_q1" value="2">
                                <span class="radio-checkmark"></span>
                                असहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec2_q1" value="3">
                                <span class="radio-checkmark"></span>
                                सहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec2_q1" value="4">
                                <span class="radio-checkmark"></span>
                                पूर्णपणे सहमत
                            </label>
                        </div>
                    </div>
                    
                    <div class="question">
                        <div class="question-text">२. मूळ विषय समजण्याच्या दृष्टीने पुरेशी आहे.</div>
                        <div class="options">
                            <label class="option custom-radio">
                                <input type="radio" name="sec2_q2" value="1" required>
                                <span class="radio-checkmark"></span>
                                पूर्णपणे असहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec2_q2" value="2">
                                <span class="radio-checkmark"></span>
                                असहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec2_q2" value="3">
                                <span class="radio-checkmark"></span>
                                सहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec2_q2" value="4">
                                <span class="radio-checkmark"></span>
                                पूर्णपणे सहमत
                            </label>
                        </div>
                    </div>
                    
                    <div class="question">
                        <div class="question-text">३. माझ्या कामात सुधारणा करण्यास उपयुक्त आहे.</div>
                        <div class="options">
                            <label class="option custom-radio">
                                <input type="radio" name="sec2_q3" value="1" required>
                                <span class="radio-checkmark"></span>
                                पूर्णपणे असहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec2_q3" value="2">
                                <span class="radio-checkmark"></span>
                                असहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec2_q3" value="3">
                                <span class="radio-checkmark"></span>
                                सहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec2_q3" value="4">
                                <span class="radio-checkmark"></span>
                                पूर्णपणे सहमत
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- Common Section 3: Use in Work -->
                <div class="section">
                    <h3 class="section-title">३. कामामध्ये वापर</h3>
                    
                    <div class="question">
                        <div class="question-text">मी मिळालेल्या ज्ञानाचा कामात उपयोग करू शकेन</div>
                        <div class="options">
                            <label class="option custom-radio">
                                <input type="radio" name="sec3_q1" value="1" required>
                                <span class="radio-checkmark"></span>
                                पूर्णपणे असहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec3_q1" value="2">
                                <span class="radio-checkmark"></span>
                                असहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec3_q1" value="3">
                                <span class="radio-checkmark"></span>
                                सहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec3_q1" value="4">
                                <span class="radio-checkmark"></span>
                                पूर्णपणे सहमत
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- Trainers Section -->
                <div class="section">
                    <h3 class="section-title">४. व्याख्यात्याबद्दल अभिप्राय</h3>
                    
                    {% for program in programs %}
                    <div class="program-section">
                        <div class="program-header">
                            <h4 class="program-title">{{ program.training_name }}</h4>
                            <div class="program-date">{{ program.start_date.strftime('%Y-%m-%d') }}</div>
                        </div>
                        
                        <!-- Hidden fields for program data -->
                        <input type="hidden" name="program_{{ program.id }}_id" value="{{ program.id }}">
                        <input type="hidden" name="program_{{ program.id }}_title" value="{{ program.training_name }}">
                        <input type="hidden" name="program_{{ program.id }}_date" value="{{ program.start_date.strftime('%Y-%m-%d') }}">
                        
                        <!-- NEW HIDDEN FIELDS FOR CATEGORIES -->
                        <input type="hidden" name="program_{{ program.id }}_pmo_training_category" value="{{ program.pmo_training_category }}">
                        <input type="hidden" name="program_{{ program.id }}_pl_category" value="{{ program.pl_category }}">
                        <input type="hidden" name="program_{{ program.id }}_brsr_sq_123_category" value="{{ program.brsr_sq_123_category }}">
                        
                        <!-- NEW HIDDEN FIELDS FOR TNI STATUS AND LEARNING HOURS -->
                        <input type="hidden" name="program_{{ program.id }}_tni_status" value="{{ program.tni_status }}">
                        <input type="hidden" name="program_{{ program.id }}_learning_hours" value="{{ program.learning_hours }}">
                        
                        {% if program.trainers %}
                            {% for trainer in program.trainers %}
                            <div class="trainer-section">
                                <div class="trainer-title">
                                    <i class="fas fa-chalkboard-teacher"></i>
                                    व्याख्याता क्र. {{ trainer.num }} : नाव : {{ trainer.name }}
                                </div>
                                <input type="hidden" name="program_{{ program.id }}_trainer{{ trainer.num }}_name" value="{{ trainer.name }}">
                                
                                <div class="question">
                                    <div class="question-text">अ) व्याख्यात्याला विषयाचे सखोल ज्ञान आहे.</div>
                                    <div class="options">
                                        <label class="option custom-radio">
                                            <input type="radio" name="program_{{ program.id }}_trainer{{ trainer.num }}_q1" value="1" required>
                                            <span class="radio-checkmark"></span>
                                            पूर्णपणे असहमत
                                        </label>
                                        <label class="option custom-radio">
                                            <input type="radio" name="program_{{ program.id }}_trainer{{ trainer.num }}_q1" value="2">
                                            <span class="radio-checkmark"></span>
                                            असहमत
                                        </label>
                                        <label class="option custom-radio">
                                            <input type="radio" name="program_{{ program.id }}_trainer{{ trainer.num }}_q1" value="3">
                                            <span class="radio-checkmark"></span>
                                            सहमत
                                        </label>
                                        <label class="option custom-radio">
                                            <input type="radio" name="program_{{ program.id }}_trainer{{ trainer.num }}_q1" value="4">
                                            <span class="radio-checkmark"></span>
                                            पूर्णपणे सहमत
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="question">
                                    <div class="question-text">ब) व्याख्यात्याकडे समजावून सांगण्याचे कौशल्य आहे.</div>
                                    <div class="options">
                                        <label class="option custom-radio">
                                            <input type="radio" name="program_{{ program.id }}_trainer{{ trainer.num }}_q2" value="1" required>
                                            <span class="radio-checkmark"></span>
                                            पूर्णपणे असहमत
                                        </label>
                                        <label class="option custom-radio">
                                            <input type="radio" name="program_{{ program.id }}_trainer{{ trainer.num }}_q2" value="2">
                                            <span class="radio-checkmark"></span>
                                            असहमत
                                        </label>
                                        <label class="option custom-radio">
                                            <input type="radio" name="program_{{ program.id }}_trainer{{ trainer.num }}_q2" value="3">
                                            <span class="radio-checkmark"></span>
                                            सहमत
                                        </label>
                                        <label class="option custom-radio">
                                            <input type="radio" name="program_{{ program.id }}_trainer{{ trainer.num }}_q2" value="4">
                                            <span class="radio-checkmark"></span>
                                            पूर्णपणे सहमत
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="question">
                                    <div class="question-text">क) व्याख्याता शंका समाधान उत्तमरित्या करू शकतो.</div>
                                    <div class="options">
                                        <label class="option custom-radio">
                                            <input type="radio" name="program_{{ program.id }}_trainer{{ trainer.num }}_q3" value="1" required>
                                            <span class="radio-checkmark"></span>
                                            पूर्णपणे असहमत
                                        </label>
                                        <label class="option custom-radio">
                                            <input type="radio" name="program_{{ program.id }}_trainer{{ trainer.num }}_q3" value="2">
                                            <span class="radio-checkmark"></span>
                                            असहमत
                                        </label>
                                        <label class="option custom-radio">
                                            <input type="radio" name="program_{{ program.id }}_trainer{{ trainer.num }}_q3" value="3">
                                            <span class="radio-checkmark"></span>
                                            सहमत
                                        </label>
                                        <label class="option custom-radio">
                                            <input type="radio" name="program_{{ program.id }}_trainer{{ trainer.num }}_q3" value="4">
                                            <span class="radio-checkmark"></span>
                                            पूर्णपणे सहमत
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="question">
                                    <div class="question-text">ड) आपले व्याख्यात्या बद्दल सर्वसाधारण मत (पेहराव, सहभाग, सादरीकरण इ.) चांगले आहे.</div>
                                    <div class="options">
                                        <label class="option custom-radio">
                                            <input type="radio" name="program_{{ program.id }}_trainer{{ trainer.num }}_q4" value="1" required>
                                            <span class="radio-checkmark"></span>
                                            पूर्णपणे असहमत
                                        </label>
                                        <label class="option custom-radio">
                                            <input type="radio" name="program_{{ program.id }}_trainer{{ trainer.num }}_q4" value="2">
                                            <span class="radio-checkmark"></span>
                                            असहमत
                                        </label>
                                        <label class="option custom-radio">
                                            <input type="radio" name="program_{{ program.id }}_trainer{{ trainer.num }}_q4" value="3">
                                            <span class="radio-checkmark"></span>
                                            सहमत
                                        </label>
                                        <label class="option custom-radio">
                                            <input type="radio" name="program_{{ program.id }}_trainer{{ trainer.num }}_q4" value="4">
                                            <span class="radio-checkmark"></span>
                                            पूर्णपणे सहमत
                                        </label>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="alert alert-warning">
                                <i class="fas fa-exclamation-triangle"></i> No trainers found for this program
                            </div>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
                
                <!-- Common Section 5: Program Organization -->
                <div class="section">
                    <h3 class="section-title">५. कार्यक्रमाचे संयोजन व इतर व्यवस्था</h3>
                    
                    <div class="question">
                        <div class="question-text">१. कार्यक्रमाचे संयोजन व इतर व्यवस्था समाधानकारक होती.</div>
                        <div class="options">
                            <label class="option custom-radio">
                                <input type="radio" name="sec5_q1" value="1" required>
                                <span class="radio-checkmark"></span>
                                पूर्णपणे असहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec5_q1" value="2">
                                <span class="radio-checkmark"></span>
                                असहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec5_q1" value="3">
                                <span class="radio-checkmark"></span>
                                सहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec5_q1" value="4">
                                <span class="radio-checkmark"></span>
                                पूर्णपणे सहमत
                            </label>
                        </div>
                    </div>
                    
                    <div class="question">
                        <div class="question-text">२. इतर पूरक व्यवस्था (चहा, नाष्टा इ.) समाधानकारक होती.</div>
                        <div class="options">
                            <label class="option custom-radio">
                                <input type="radio" name="sec5_q2" value="1" required>
                                <span class="radio-checkmark"></span>
                                पूर्णपणे असहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec5_q2" value="2">
                                <span class="radio-checkmark"></span>
                                असहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec5_q2" value="3">
                                <span class="radio-checkmark"></span>
                                सहमत
                            </label>
                            <label class="option custom-radio">
                                <input type="radio" name="sec5_q2" value="4">
                                <span class="radio-checkmark"></span>
                                पूर्णपणे सहमत
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Common Section 6: Program Details -->
                <div class="section">
                    <h3 class="section-title">६. कार्यक्रमा बाबत</h3>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <div class="question">
                                <div class="question-text">अ) कार्यक्रमाची गती :</div>
                                <div class="options">
                                    <label class="option custom-radio">
                                        <input type="radio" name="sec6_q1" value="1" required>
                                        <span class="radio-checkmark"></span>
                                        धीमी (हळू)
                                    </label>
                                    <label class="option custom-radio">
                                        <input type="radio" name="sec6_q1" value="2">
                                        <span class="radio-checkmark"></span>
                                        योग्य
                                    </label>
                                    <label class="option custom-radio">
                                        <input type="radio" name="sec6_q1" value="3">
                                        <span class="radio-checkmark"></span>
                                        वेगवान
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <div class="question">
                                <div class="question-text">ब) कार्यक्रमाचा कालावधी :</div>
                                <div class="options">
                                    <label class="option custom-radio">
                                        <input type="radio" name="sec6_q2" value="1" required>
                                        <span class="radio-checkmark"></span>
                                        कमी
                                    </label>
                                    <label class="option custom-radio">
                                        <input type="radio" name="sec6_q2" value="2">
                                        <span class="radio-checkmark"></span>
                                        योग्य
                                    </label>
                                    <label class="option custom-radio">
                                        <input type="radio" name="sec6_q2" value="3">
                                        <span class="radio-checkmark"></span>
                                        जास्त
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Common Section 7: Overall Evaluation -->
                <div class="section">
                    <h3 class="section-title">७. कार्यक्रमाचे सर्वसाधारण मूल्यमापन</h3>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <div class="question">
                                <div class="question-text">अ) उपयोगाच्या दृष्टीकोनातून या कार्यक्रमाचे मूल्यमापन करा :</div>
                                <div class="options">
                                    <label class="option custom-radio">
                                        <input type="radio" name="sec7_q1" value="1" required>
                                        <span class="radio-checkmark"></span>
                                        अतिशय नि:कृष्ट
                                    </label>
                                    <label class="option custom-radio">
                                        <input type="radio" name="sec7_q1" value="2">
                                        <span class="radio-checkmark"></span>
                                        नि:कृष्ट
                                    </label>
                                    <label class="option custom-radio">
                                        <input type="radio" name="sec7_q1" value="3">
                                        <span class="radio-checkmark"></span>
                                        उत्कृष्ट
                                    </label>
                                    <label class="option custom-radio">
                                        <input type="radio" name="sec7_q1" value="4">
                                        <span class="radio-checkmark"></span>
                                        अतिशय उत्कृष्ट
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <div class="question">
                                <div class="question-text">ब) तुमच्या इतर सहकाऱ्यांनी सुध्दा या कार्यक्रमात यावे असे वाटते का?</div>
                                <div class="options">
                                    <label class="option custom-radio">
                                        <input type="radio" name="sec7_q2" value="1" required>
                                        <span class="radio-checkmark"></span>
                                        होय
                                    </label>
                                    <label class="option custom-radio">
                                        <input type="radio" name="sec7_q2" value="2">
                                        <span class="radio-checkmark"></span>
                                        सांगता येत नाही
                                    </label>
                                    <label class="option custom-radio">
                                        <input type="radio" name="sec7_q2" value="3">
                                        <span class="radio-checkmark"></span>
                                        नाही
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <div class="question">
                            <div class="question-text">क) यातील कोणता विषय तुम्हाला सर्वात जास्त संबंधीत वाटला?</div>
                            <textarea name="sec7_q3_text" placeholder="तुमचे उत्तर येथे लिहा..."></textarea>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <div class="question">
                            <div class="question-text">ड) या कार्यक्रमामध्ये एखाद्या विषयाचा समावेश झाला नाही असे आपणांस वाटते का? असल्यास तो विषय कोणता?</div>
                            <textarea name="sec7_q4_text" placeholder="तुमचे उत्तर येथे लिहा..."></textarea>
                        </div>
                    </div>
                </div>
                
                <!-- Common Suggestions Section -->
                <div class="section">
                    <h3 class="section-title">८. सुधारणेबाबत सूचना</h3>
                    
                    <div class="form-group">
                        <div class="question">
                            <div class="question-text">या कार्यक्रमाच्या सुधारणेबाबत काही सूचना असल्यास खाली लिहा :</div>
                            <textarea name="suggestions" placeholder="तुमचे सुचना येथे लिहा..."></textarea>
                        </div>
                    </div>
                </div>
                
                <!-- Submit Buttons -->
                <div class="btn-container">
                    <button type="submit" class="btn btn-submit">
                        <i class="fas fa-paper-plane"></i> सबमिट करा
                    </button>
                    <button type="reset" class="btn btn-reset">
                        <i class="fas fa-undo"></i> रिसेट करा
                    </button>
                </div>
            </form>
        </div>
        
        <div class="footer">
        </div>
    </div>

    <script>
    $(document).ready(function() {
        // Ensure program_ids field is properly set
        const programIdsField = $('#program_ids_field');
        if (!programIdsField.val() && window.location.search) {
            const urlParams = new URLSearchParams(window.location.search);
            const programs = urlParams.get('programs');
            if (programs) {
                programIdsField.val(programs);
            }
        }
        
        // If still no program IDs, try to get from session storage
        if (!programIdsField.val()) {
            const sessionPrograms = sessionStorage.getItem('clubbed_program_ids');
            if (sessionPrograms) {
                programIdsField.val(sessionPrograms);
            }
        }
        
        // Store program IDs in session storage for later use
        if (programIdsField.val()) {
            sessionStorage.setItem('clubbed_program_ids', programIdsField.val());
        }
        
        // Employee verification functionality
        $('#verifyPerNoBtn').click(function() {
            const perNo = $('#per_no').val().trim();
            const verifyBtn = $(this);
            const verifyText = $('#verifyText');
            const verifySpinner = $('#verifySpinner');
            const errorField = $('#perNoError');
            
            if (!perNo) {
                errorField.text('Please enter a PER number');
                $('#per_no').addClass('is-invalid');
                return;
            }
            
            // Show loading state
            verifyBtn.prop('disabled', true);
            verifyText.text('Verifying...');
            verifySpinner.show();
            errorField.text('');
            $('#per_no').removeClass('is-invalid');
            
            $.ajax({
                url: '/feedback/verify_employee',
                type: 'POST',
                data: { per_no: perNo },
                success: function(data) {
                    console.log('Response:', data);

                    if (data.success) {
                        // Populate employee details
                        $('#participants_name').text(data.employee.participants_name || 'N/A');
                        $('#bc_no').text(data.employee.bc_no || 'N/A');
                        $('#gender').text(data.employee.gender || 'N/A');
                        $('#employee_group').text(data.employee.employee_group || 'N/A');
                        $('#department').text(data.employee.department || 'N/A');
                        $('#factory').text(data.employee.factory || 'N/A');
                        
                        // Set hidden field value
                        $('#participants_name_hidden').val(data.employee.participants_name || '');
                        
                        // Show employee section
                        $('#employeeSection').slideDown();
                        
                        // Clear SeniorName field (fixing the issue)
                        $('#SeniorName').val('');
                    } else {
                        errorField.text(data.error || 'Error verifying employee');
                        $('#per_no').addClass('is-invalid');
                        $('#employeeSection').hide();
                    }
                },
                error: function(xhr) {
                    console.error('Error:', xhr);
                    errorField.text('Error verifying employee');
                    $('#per_no').addClass('is-invalid');
                    $('#employeeSection').hide();
                },
                complete: function() {
                    // Reset button state
                    verifyBtn.prop('disabled', false);
                    verifyText.text('Verify');
                    verifySpinner.hide();
                }
            });
        });

        // Form validation
        $('#clubbedFeedbackForm').submit(function(e) {
            e.preventDefault();
            let isValid = true;
            
            // Check if program_ids field is empty
            if (!programIdsField.val()) {
                alert('Program IDs are missing. Please refresh the page and try again.');
                isValid = false;
            }
            
            // Validate PER number verification
            if ($('#employeeSection').is(':hidden')) {
                $('#perNoError').text('Please verify your PER number first');
                $('#per_no').addClass('is-invalid');
                isValid = false;
            }

            // Validate required fields
            $('input[required]').each(function() {
                if (!$(this).val()) {
                    isValid = false;
                    $(this).addClass('is-invalid');
                } else {
                    $(this).removeClass('is-invalid');
                }
            });
            
            // Validate radio buttons
            $('input[type="radio"][required]').each(function() {
                const name = $(this).attr('name');
                if (!$(`input[name="${name}"]:checked`).length) {
                    isValid = false;
                    const question = $(this).closest('.question');
                    if (question.length) {
                        question.css('backgroundColor', '#fff0f0');
                    }
                }
            });

            if (isValid) {
                // Sweet alert or confirmation before submit
                if (confirm('तुम्हाला नक्की सर्व कार्यक्रमांसाठी हा अभिप्राय सबमिट करायचा आहे का?')) {
                    alert('धन्यवाद! तुमचा अभिप्राय यशस्वीरित्या सबमिट केला गेला आहे.');
                    this.submit();
                }
            } else {
                alert('कृपया सर्व आवश्यक फील्ड भरा.');
                $('html, body').animate({
                    scrollTop: $(".is-invalid").first().offset().top - 100
                }, 500);
            }
        });
        
        // Reset form button
        $('.btn-reset').click(function() {
            if (confirm('तुम्हाला नक्की फॉर्म रिसेट करायचे आहे का?')) {
                $('#clubbedFeedbackForm')[0].reset();
                $('.question').css('backgroundColor', '#f8fafc');
                // Also hide employee section on reset
                $('#employeeSection').hide();
            }
        });
        
        // Add animation to radio buttons when selected
        $('input[type="radio"]').change(function() {
            const checkmark = $(this).siblings('.radio-checkmark');
            checkmark.css('transform', 'scale(0.8)');
            setTimeout(() => {
                checkmark.css('transform', 'scale(1)');
            }, 200);
            
            // Remove error highlight from question
            $(this).closest('.question').css('backgroundColor', '#f8fafc');
        });
        
        // Add focus effects
        $('input, textarea').focus(function() {
            $(this).parent().find('.floating-label').addClass('active');
        }).blur(function() {
            if (!$(this).val()) {
                $(this).parent().find('.floating-label').removeClass('active');
            }
        });
    });
    </script>
</body>
</html>